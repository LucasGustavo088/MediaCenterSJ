<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Post</title>

<script th:src="@{/js/jquery.min.js}"></script>


<link rel="stylesheet" th:href="@{/css/bootstrap.css}" />

<script th:src="@{/js/bootstrap.js}"></script>


<link rel="stylesheet"
	href="https://www.jqueryscript.net/css/jquerysctipttop.css">

<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bs-stepper/dist/css/bs-stepper.min.css">
<script defer
	src="https://cdn.jsdelivr.net/npm/bs-stepper/dist/js/bs-stepper.min.js"></script>


<link rel="stylesheet"
	href="https://www.jqueryscript.net/demo/Tags-Input-Autocomplete/src/jquery.tagsinput-revisited.css">

<link rel="stylesheet"
	href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">




<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">

<link rel="stylesheet"
	href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet"
	href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>


<link rel="stylesheet" th:href="@{/css/froala_editor.css}" />
<link rel="stylesheet" th:href="@{/css/froala_style.css}" />

<link rel="stylesheet" th:href="@{/css/plugins/code_view.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/colors.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/emoticons.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/image_manager.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/image.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/line_breaker.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/quick_insert.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/table.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/file.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/char_counter.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/video.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/emoticons.css}" />
<link rel="stylesheet" th:href="@{/css/plugins/fullscreen.css}" />

<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.3.0/codemirror.min.css">

<style type="text/css">
.invisivel {
	display: none;
}
</style>

</head>
<body>

	<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
		<a class="navbar-brand" href="/figuras">Plataforma</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse"
			data-target="#navbarNav" aria-controls="navbarNav"
			aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav">
				<li class="nav-item"><a class="nav-link" href="/categorias">Categorias
				</a></li>
				<li class="nav-item"><a class="nav-link" href="/tags">Tags</a></li>
				<li class="nav-item"><a class="nav-link" href="/materiais">Materiais</a></li>


			</ul>
		</div>
	</nav>

	<div class="container-fluid">

		<div class="row" style="margin-top: 20px">

			<div class="col-md-12">

				<h1 class="text-right" style="margin: 10px 0 20px 0">
					<span class="badge" style="background-color: #AB0F41; color: #fff">Post</span>
				</h1>


			</div>

		</div>

		<!--  -->

		<div class="row">

			<div class="col-md-12">


				<!--  -->

				<div class="row">

					<div class="col-md-2">


						<input type="text" class="form-control" aria-label="Small"
							aria-describedby="inputGroup-sizing-sm" name="filtro"
							id="filtrar-tabela" placeholder="Pesquisar material"
							style="margin: 26px 0">

						<!-- 555 -->

						<div th:each="material : ${materiais}" class="text-center"
							id="materiais">


							<div class="card p-1 m-3 material"
								th:if="${#strings.contains(material, 'Figura')}">


								<a href="#" data-toggle="modal"
									th:data-target="'#cam_' + ${material.id}" title="Detalhes">
									<img class="card-img-top text-center"
									th:src="@{${'http://localhost:3000/' + material.url }}"
									alt="Img" border="0" />

								</a>

								<div class="card-body text-center"
									style="margin: 0; padding: 2px 0">


									<p class="card-title" th:text="${material.nome}"
										style="margin: 0; padding: 2px 0"></p>

									<p class="card-text text-muted">
										<small
											th:text="${#temporals.format(material.dataRegistro, 'dd/MM/yyyy HH:mm')}"></small>
									</p>

								</div>

							</div>


							<div class="card p-1 m-3 material"
								th:if="${#strings.contains(material, 'Texto')}"
								style="padding: 5px 0">

								<div class="card-body text-center"
									style="margin: 0; padding: 2px 0">

									<a th:href="@{${'http://localhost:3000/' + material.url }}"
										target="_blank" th:title="${material.nome}"
										th:text="${material.nome}"> </a>


									<p class="card-text text-muted">
										<a href="#" data-toggle="modal"
											th:data-target="'#cam_' + ${material.id}"
											class="badge badge-info" target="_blank">Texto</a> <small
											th:text="${#temporals.format(material.dataRegistro, 'dd/MM/yyyy HH:mm')}"></small>
									</p>
								</div>

							</div>



							<div class="card p-1 m-3 material"
								th:if="${#strings.contains(material, 'Audio')}"
								style="padding: 5px 0">

								<div class="card-body text-center"
									style="margin: 0; padding: 2px 0">

									<a th:href="@{${'http://localhost:3000/' + material.url }}"
										target="_blank" th:title="${material.nome}"
										th:text="${material.nome}"> </a>



									<p class="card-text text-muted">
										<a href="#" data-toggle="modal"
											th:data-target="'#cam_' + ${material.id}"
											class="badge badge-info" target="_blank">Áudio</a> <small
											th:text="${#temporals.format(material.dataRegistro, 'dd/MM/yyyy HH:mm')}"></small>
									</p>
								</div>

							</div>

							<div class="card p-1 m-3 material"
								th:if="${#strings.contains(material, 'Video')}"
								style="padding: 5px 0">

								<div class="card-body text-center"
									style="margin: 0; padding: 2px 0">

									<a th:href="@{${'http://localhost:3000/' + material.url }}"
										target="_blank" th:title="${material.nome}"
										th:text="${material.nome}"> </a>



									<p class="card-text text-muted">
										<a href="#" data-toggle="modal"
											th:data-target="'#cam_' + ${material.id}"
											class="badge badge-info" target="_blank">Vídeo</a> <small
											th:text="${#temporals.format(material.dataRegistro, 'dd/MM/yyyy HH:mm')}"></small>
									</p>
								</div>

							</div>

						</div>

					</div>



					<div class="col-md-10">

						<form method="post" th:action="@{/posts}" th:object="${post}"
							id="form">

							<div class="form-group" style="font-size: 1.2em">
								<label for="nome"><b>Título</b></label> <input type="text"
									class="form-control" id="titulo" name="titulo"
									aria-describedby="titulo" th:field="*{titulo}">
							</div>


							<h6 style="margin: 24px 0 4px 0">
								<b>Tags</b>
							</h6>

							<input id="tags" name="tags" type="text" class="form-control"
								th:field="*{tags}">
								
								
								<input id="destaque" name="destaque" type="text" class="form-control"
								th:field="*{destaque}">


							<h6 style="margin: 30px 0 7px 0">
								<b>Categorias</b>
							</h6>

							<div class="clearfix"></div>

							<div style="border: 1px solid #ddd; margin: 0; float: left;"
								class="rounded">

								<div style="float: left; margin: 5px 12px 4px 0; padding: 7px"
									th:each="categoria : ${categorias}">
									<label
										class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect"
										th:for="'cat_' + ${categoria.id}"> <input
										type="checkbox" th:value="${categoria.id}"
										th:id="'cat_' +${categoria.id}" name="categorias[]"
										class="mdl-checkbox__input" th:field="*{categorias}">
										<span class="mdl-checkbox__label" th:text="${categoria.nome}"></span>
									</label>
								</div>

							</div>

							<div class="clearfix"></div>

							<div class="form-group"
								style="margin-top: 24px; font-size: 1.2em">
								<label for="nome"><b>Conteúdo</b></label>
							</div>

							<div id="editor" style="margin-left: 45px; border-left:">
								<div id='edit' style="min-height: 800px !important;">

									<p>...</p>

								</div>
							</div>

							<input id="conteudo" name="conteudo" type="text" class="form-control"
								th:field="*{conteudo}">

							<button type="submit" class="btn btn btn-primary float-right"
								style="margin: 30px 0">Salvar</button>

						</form>

					</div>



				</div>



				<!--  -->



			</div>


		</div>



	</div>


	<!-- Modal Detalhes -->
	<div th:each="material : ${materiais}">

		<div th:if="${#strings.contains(material, 'Figura')}">

			<div class="modal fade" th:id="'cam_' + ${material.id}" tabindex="-1"
				role="dialog" th:aria-labelledby="'cam_' + ${material.id}"
				aria-hidden="true">
				<div class="modal-dialog modal-dialog-centered mw-100 w-50"
					role="document">
					<div class="modal-content">

						<div class="modal-body">

							<div class="row">

								<div class="col-md-4 text-center">

									<img th:src="@{${'http://localhost:3000/' + material.url }}"
										alt="Img" class="img-fluid" style="border: 0;" /> <small><span
										th:text="${material.tamanho}"></span></small>

								</div>

								<div class="col-md-8">


									<div style="margin: 0; padding: 0">
										<small><b>Nome</b></small>
									</div>

									<p th:text="${material.nome}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Nome original</b></small>
									</div>

									<p th:text="${material.nomeOriginal}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Autor</b></small>
									</div>

									<p th:text="${material.autor}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Tags</b></small>
									</div>

									<p th:text="${material.tags}"></p>


									<div style="margin: 0; padding: 0">
										<small><b>Categorias</b></small>
									</div>

									<th:block th:each="categoria : ${material.categorias}">

										<small><span th:text="${categoria.nome}"
											style="padding: 4px; margin: 6px 2px 6px 0px; background-color: #212529; color: #fff"></span></small>

									</th:block>


								</div>


							</div>

						</div>
					</div>
				</div>
			</div>

		</div>

		<div th:if="${#strings.contains(material, 'Texto')}">

			<div class="modal fade" th:id="'cam_' + ${material.id}" tabindex="-1"
				role="dialog" th:aria-labelledby="'cam_' + ${material.id}"
				aria-hidden="true">
				<div class="modal-dialog modal-dialog-centered mw-100 w-50"
					role="document">
					<div class="modal-content">

						<div class="modal-body">

							<div class="row">

								<div class="col-md-4 text-center">

									<img class="img-fluid" src="/figuras/iconPdf.png" alt="Img"
										style="width: 96px; height: 96px; border: 0" border="0">

									<p>
										<small><span th:text="${material.tamanho}"></span></small>
									</p>

								</div>

								<div class="col-md-8">

									<div style="margin: 0; padding: 0">
										<small><b>Nome</b></small>
									</div>

									<p th:text="${material.nome}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Nome original</b></small>
									</div>

									<p th:text="${material.nomeOriginal}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Resumo</b></small>
									</div>

									<p th:text="${material.resumo}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Tags</b></small>
									</div>

									<p th:text="${material.tags}"></p>


									<div style="margin: 0; padding: 0">
										<small><b>Categorias</b></small>
									</div>

									<th:block th:each="categoria : ${material.categorias}">

										<small><span th:text="${categoria.nome}"
											style="padding: 4px; margin: 6px 2px 6px 0px; background-color: #212529; color: #fff"></span></small>

									</th:block>


								</div>

							</div>

						</div>
					</div>
				</div>
			</div>

		</div>

		<div th:if="${#strings.contains(material, 'Audio')}">

			<div class="modal fade" th:id="'cam_' + ${material.id}" tabindex="-1"
				role="dialog" th:aria-labelledby="'cam_' + ${material.id}"
				aria-hidden="true">
				<div class="modal-dialog modal-dialog-centered mw-100 w-50"
					role="document">
					<div class="modal-content">

						<div class="modal-body">

							<div class="row">

								<div class="col-md-4 text-center">

									<img class="img-fluid" src="/figuras/iconMp3.png" alt="Img"
										style="width: 96px; height: 96px; border: 0" border="0">

									<p>
										<small><span th:text="${material.tamanho}"></span></small>
									</p>

								</div>

								<div class="col-md-8">

									<div style="margin: 0; padding: 0">
										<small><b>Nome</b></small>
									</div>

									<p th:text="${material.nome}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Nome original</b></small>
									</div>

									<p th:text="${material.nomeOriginal}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Duração</b></small>
									</div>

									<p th:text="${material.duracao} + ' Min.'"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Tags</b></small>
									</div>

									<p th:text="${material.tags}"></p>


									<div style="margin: 0; padding: 0">
										<small><b>Categorias</b></small>
									</div>

									<th:block th:each="categoria : ${material.categorias}">

										<small><span th:text="${categoria.nome}"
											style="padding: 4px; margin: 6px 2px 6px 0px; background-color: #212529; color: #fff"></span></small>

									</th:block>


								</div>

							</div>

						</div>
					</div>
				</div>
			</div>

		</div>

		<div th:if="${#strings.contains(material, 'Video')}">

			<div class="modal fade" th:id="'cam_' + ${material.id}" tabindex="-1"
				role="dialog" th:aria-labelledby="'cam_' + ${material.id}"
				aria-hidden="true">
				<div class="modal-dialog modal-dialog-centered mw-100 w-50"
					role="document">
					<div class="modal-content">

						<div class="modal-body">

							<div class="row">

								<div class="col-md-4 text-center">

									<img class="img-fluid" src="/figuras/iconVideo.png" alt="Img"
										style="width: 96px; height: 96px; border: 0" border="0">

									<p>
										<small><span th:text="${material.tamanho}"></span></small>
									</p>

								</div>

								<div class="col-md-8">

									<div style="margin: 0; padding: 0">
										<small><b>Nome</b></small>
									</div>

									<p th:text="${material.nome}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Nome original</b></small>
									</div>

									<p th:text="${material.nomeOriginal}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Produção</b></small>
									</div>

									<p th:text="${material.producao}"></p>

									<div style="margin: 0; padding: 0">
										<small><b>Tags</b></small>
									</div>

									<p th:text="${material.tags}"></p>


									<div style="margin: 0; padding: 0">
										<small><b>Categorias</b></small>
									</div>

									<th:block th:each="categoria : ${material.categorias}">

										<small><span th:text="${categoria.nome}"
											style="padding: 4px; margin: 6px 2px 6px 0px; background-color: #212529; color: #fff"></span></small>

									</th:block>


								</div>

							</div>


						</div>
					</div>
				</div>
			</div>

		</div>


	</div>


	<script th:src="@{/js/froala_editor.min.js}"></script>
	<script th:src="@{/js/plugins/align.min.js}"></script>
	<script th:src="@{/js/plugins/code_beautifier.min.js}"></script>
	<script th:src="@{/js/plugins/code_view.min.js}"></script>
	<script th:src="@{/js/plugins/colors.min.js}"></script>
	<script th:src="@{/js/plugins/emoticons.min.js}"></script>
	<script th:src="@{/js/plugins/draggable.min.js}"></script>
	<script th:src="@{/js/plugins/font_size.min.js}"></script>
	<script th:src="@{/js/plugins/font_family.min.js}"></script>
	<script th:src="@{/js/plugins/image.min.js}"></script>
	<script th:src="@{/js/plugins/image_manager.min.js}"></script>
	<script th:src="@{/js/plugins/line_breaker.min.js}"></script>
	<script th:src="@{/js/plugins/quick_insert.min.js}"></script>
	<script th:src="@{/js/plugins/link.min.js}"></script>
	<script th:src="@{/js/plugins/lists.min.js}"></script>
	<script th:src="@{/js/plugins/paragraph_format.min.js}"></script>
	<script th:src="@{/js/plugins/paragraph_style.min.js}"></script>
	<script th:src="@{/js/plugins/video.min.js}"></script>
	<script th:src="@{/js/plugins/table.min.js}"></script>
	<script th:src="@{/js/plugins/url.min.js}"></script>
	<script th:src="@{/js/plugins/emoticons.min.js}"></script>
	<script th:src="@{/js/plugins/file.min.js}"></script>
	<script th:src="@{/js/plugins/entities.min.js}"></script>
	<script th:src="@{/js/plugins/inline_style.min.js}"></script>
	<script th:src="@{/js/plugins/save.min.js}"></script>
	<script th:src="@{/js/plugins/fullscreen.min.js}"></script>

	<script
		src="https://www.jqueryscript.net/demo/Tags-Input-Autocomplete/src/jquery.tagsinput-revisited.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>


	<script type="text/javascript" th:inline="javascript">
			/*<![CDATA[*/
		
			
			<!-- 555 -->

			var campo = document.querySelector("#filtrar-tabela");

			campo.addEventListener("input", function() {
				
				var materiais_div = document.querySelector("#materiais");				
				
				var materiais = document.querySelectorAll(".material");
				

				if (this.value.length > 0) {
					
					materiais.forEach(function (material) {
						
						material.classList.add("invisivel");
												
					});
					
															
					var xhr = new XMLHttpRequest();
					
					xhr.open("GET", "http://localhost:8080/api/materiais/filtrar/" + this.value);

					xhr.addEventListener("load", function () {
					
						if (xhr.status == 200) {
							
							console.log(xhr.status);
				            console.log(xhr.responseText);
				            
				            var resposta = xhr.responseText;
				            var lista = JSON.parse(resposta);
				            
				            
				            lista.forEach(function (material) {
				            	
				            	var dataString = new Date(material.dataRegistro);
				            	
				            	var data = dataString.getDate() + '/' + (dataString.getMonth() + 1) + '/' +  dataString.getFullYear() + ' ' + dataString.getHours() + ':' + dataString.getMinutes(); 
				            
				            	var materialDiv = document.createElement("div");
				            					            	
				            	materialDiv.innerHTML = '<div class=\"card p-1 m-3 material\"><a href=\"#\" data-toggle=\"modal\"th:data-target=\"#cam_1\" title=\"Detalhes\"><img class=\"card-img-top text-center\" src=\"http://localhost:3000/'+ material.url +'"alt=\"Img\" border=\"0\" /></a><div class=\"card-body text-center\"style=\"margin: 0; padding: 2px 0\"><p class=\"card-title\"style=\"margin: 0; padding: 2px 0\">'+ material.nome +'</p><p class=\"card-text text-muted\"><small>'+ data +'</small></p></div></div>';
				            				            
				            	materiais_div.appendChild(materialDiv);
				            
				            });
				           				            
				            
						}
						
					});
					
					xhr.send();					
				
				} else {
					
					//document.getElementsByClassName("material").remove();
					
					 materiais.forEach(function (material) {
						
						material.remove();
												
					}); 

					
				}

			});
			
			/* Injeta categorias e tags no form atual e realiza o envio */
			function enviar(){	
	 			
	 			/* Array.prototype.map.call(document.querySelectorAll("input[name^='categorias[']:checked"), e => {
	 			 			 				
	 				let campoCategorias = document.createElement("input");
	 				campoCategorias.setAttribute('type', 'checkbox');
	 				campoCategorias.name = "categorias"; 
	 				campoCategorias.value = e.value;
	 				campoCategorias.checked = true;
	 				form.appendChild(campoCategorias);	
	 						 				
	 			});
	 			
	 			
				let campoTags = document.createElement('input');
			 	
				campoTags.type = 'text';
				campoTags.name = 'tags';
				campoTags.value = document.querySelector('#tags').value;
				form.appendChild(campoTags);
	 			
				document.querySelector("#form").submit(); */	 			
	 					
			}
			

			$(document)
					.ready(
							function() {

								$('#edit')
										.froalaEditor(
												{
													toolbarInline : true,
													toolbarButtons : [ 'bold',
															'italic',
															'underline',
															'strikeThrough',
															'color',
															'emoticons',
															'undo', 'redo',
															'-',
															'paragraphFormat',
															'align',
															'formatOL',
															'formatUL',
															'indent',
															'outdent',
															'insertLink' ],
													toolbarButtonsXS : null,
													toolbarButtonsSM : null,
													toolbarButtonsMD : null,
													
													imageDefaultAlign : 'center',

													quickInsertButtons : [
															'embedly', 'table',
															'ul', 'ol', 'hr','video' ],
													imageEditButtons : [
															'imageAlign',
															'imageRemove',
															'imageDisplay',
															'imageStyle',
															'imageSize' ]
												});
								
								
								$('#tags').tagsInput({
									
									  interactive: true,
									  placeholder: 'Adicionar tag',
									  width: 'auto',
									  height: 'auto',
									  hide: true,
									  delimiter: ', ',
									  removeWithBackspace: true
								});
								
								
								$("#form").submit(function( event ) {
									  
									var markupStr = $('#edit')
									.froalaEditor('html.get',
											true);
									
									 $("#conteudo").val(markupStr);
									 
								});
								

								/* $("#enviar").click(
										function() { 
											
											var markupStr = $('#edit')
													.froalaEditor('html.get',
															true);

											console.log(markupStr);
											
											$("#conteudo").html(markupStr);
											
											$("#titulo").val(markupStr);
								}); */
								

							});

			/*]]>*/
		</script>
</body>
</html>